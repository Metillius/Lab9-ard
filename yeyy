import mysql.connector

dataBase = mysql.connector.connect(
    host="localhost",
    user="root",
    passwd=""
)

cursorObject = dataBase.cursor()
cursorObject.execute("DROP DATABASE LulDatabase")
cursorObject.execute("CREATE DATABASE LulDatabase")

connection = mysql.connector.connect(

    host="localhost",
    user="root",
    database='LulDatabase',
    passwd=""

)
if connection.is_connected():
    db_Info = connection.get_server_info()
    print("Connected to MYSQL Server version ", db_Info)
    cursor = connection.cursor()
    cursor.execute("select database();")
    record = cursor.fetchone()
    print("You're connected to database", record)

#cursorObject.EXECUTE("DROP DATABASE MyNewDatabase")

try:
    connection=mysql.connector.connect(
        host="localhost",
        database='lulDATABASE',
        user="root",
        passwd="")

    mySql_Create_Table_Query ="""CREATE TABLE Avengers(
                                ID int(2) NOT NULL,
                                MOVIE varchar(15) NOT NULL,
                                DATE varchar(20) NOT NULL,
                                MCU_PHASE varchar(7) NOT NULL
                                )"""

    cursor = connection.cursor()
    result = cursor.execute(mySql_Create_Table_Query)
    print("Students Table created succesfully")

    cursor.execute("SHOW TABLES")
    for table_name in cursor:
        print(table_name)


except mysql.connector.Error as error:
    print("Failed to create table in MySQL: {}".format(error))
finally:
    if connection.is_connected():
        cursor.close()
        connection.close()
        print("MySQL connection is closed")


